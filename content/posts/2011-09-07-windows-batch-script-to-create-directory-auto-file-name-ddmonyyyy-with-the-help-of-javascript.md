---
layout: post
title: "Windows batch script to create directory auto file name DDMONYYYY with the help of javascript"
date: 2011-09-07T17:54:00+05:30
tags:
 - Batch Script
 - Windows XP
---

In the [previous](/windows-batch-script-to-create-directory-name-ddmmyyyy)
I had shown a windows batch script for creating directories with name of format
**DDMMYYYY**. In this post I will show you how to create directories of format
**DDMONYYYY**. I did a lot of research on web to figure this out. Here is the
script, it looks a little bit complex.

``` sh
:: Auto directory date batch (DDMONYYYY format)
:: In Win32, use WSH/JS to create directory in format DDMONYYYY,
:: using temporary javascript and batch files.
:: JS file is used for for getting MON
:: @author Deepu Mohan Puthrote https://deepumohan.com
@echo off
:: Declare function fnMonthLookUp
echo function fnMonthLookUp () {} &gt; tmpDate.js
:: Create array on fnMonthLookUp
echo fnMonthLookUp['1'] = 'JAN'; &gt;&gt; tmpDate.js
echo fnMonthLookUp['2'] = 'FEB'; &gt;&gt; tmpDate.js
echo fnMonthLookUp['3'] = 'MAR'; &gt;&gt; tmpDate.js
echo fnMonthLookUp['4'] = 'APR'; &gt;&gt; tmpDate.js
echo fnMonthLookUp['5'] = 'MAY'; &gt;&gt; tmpDate.js
echo fnMonthLookUp['6'] = 'JUN'; &gt;&gt; tmpDate.js
echo fnMonthLookUp['7'] = 'JUL'; &gt;&gt; tmpDate.js
echo fnMonthLookUp['8'] = 'AUG'; &gt;&gt; tmpDate.js
echo fnMonthLookUp['9'] = 'SEP'; &gt;&gt; tmpDate.js
echo fnMonthLookUp['10'] = 'OCT'; &gt;&gt; tmpDate.js
echo fnMonthLookUp['11'] = 'NOV'; &gt;&gt; tmpDate.js
echo fnMonthLookUp['12'] = 'DEC'; &gt;&gt; tmpDate.js
:: Get Date
echo var D = new Date(); &gt;&gt; tmpDate.js
echo var dd = D.getDate(); &gt;&gt; tmpDate.js
echo var mm = D.getMonth()+1; &gt;&gt; tmpDate.js
echo var yyyy = D.getFullYear(); &gt;&gt; tmpDate.js
echo var mon = fnMonthLookUp[mm]; &gt;&gt; tmpDate.js
echo var date = dd + mon + yyyy; &gt;&gt; tmpDate.js
echo WScript.Echo('mkdir '+date); &gt;&gt;tmpDate.js
cscript //nologo tmpDate.js &gt; tmpDate.bat
del tmpDate.js
call tmpDate
del tmpDate.bat
```

Copy and paste this code into a file with extension <b>bat</b> and save it into
a path where you want to create the directory. Please do share your comments.

You can also download the batch file from
[here](https://files.deepumohan.com/winbatch/DDMONYYYY.bat). You can safely
download it, it is hosted is safe server of
[HostGator](https://secure.hostgator.com/%7Eaffiliat/cgi-bin/affiliates/clickthru.cgi?id=deepumohanp).

The above script creates a tempDate.js and tempDate.bat file. Windows can run
javascript file using the command
[cscript](https://technet.microsoft.com/en-us/library/bb490887.aspx) . Output of
this javascript file is taken to tmpDate.bat file.

A sample javascript file generated by the above code is given below.

```js
function fnMonthLookUp () {}
fnMonthLookUp['1'] = 'JAN';
fnMonthLookUp['2'] = 'FEB';
fnMonthLookUp['3'] = 'MAR';
fnMonthLookUp['4'] = 'APR';
fnMonthLookUp['5'] = 'MAY';
fnMonthLookUp['6'] = 'JUN';
fnMonthLookUp['7'] = 'JUL';
fnMonthLookUp['8'] = 'AUG';
fnMonthLookUp['9'] = 'SEP';
fnMonthLookUp['10'] = 'OCT';
fnMonthLookUp['11'] = 'NOV';
fnMonthLookUp['12'] = 'DEC';
var D = new Date();
var dd = D.getDate();
var mm = D.getMonth()+1;
var yyyy = D.getFullYear();
var mon = fnMonthLookUp[mm];
var date = dd + mon + yyyy;
WScript.Echo('mkdir '+date);
```

As you can see a javascript array is created that holds index for each month.
Next we create a new Date object using javascript function `new Date()`. From
the date object get the **date**, _month_ and _year_. Next we get the MON format
of month from the javascript array already created. Now in `date` variable we
have the date in the required format. `WScript.Echo()` command will give the
output. And the output will be <b>mkdir <i>DDMONYYYY</i></b>. This output is
taken into the tmpDate.bat file. Then the tmpDate.js file is deleted and
tmpDate.bat file is executed using the call command.

In the next post I shall give an improved version.

For those who are new to windows batch files, visit [this site](https://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/batch.mspx?mfr=true)
by [Microsoft](https://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/batch.mspx?mfr=true).
