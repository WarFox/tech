---
layout: post
title: "Oracle SQL to calculate value based on previous row value"
date: 2011-12-21T20:29:00+05:30
categories:
 - How To
 - Oracle
---

<div class='post'>
<div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on">Oracle database allows you to use SQL to calculate value based on the values of the previous row in a query result set.&nbsp;Use LAG and LEAD analytic function to calculate based on previous rows values.<br /><br />Usage:<br />Both functions have the same usage, as shown below.<br />LAG  (value_expression [,offset] [,default]) OVER ([query_partition_clause] order_by_clause)<br />LEAD (value_expression [,offset] [,default]) OVER ([query_partition_clause] order_by_clause)<br /><br />Description:<br />value_expression - Can be a column or a built-in function, except for other analytic functions. <br />offset - The number of rows preceeding/following the current row, from which the data is to be retrieved. The default value is 1. <br />default - The value returned if the offset is outside the scope of the window. The default value is NULL.<br /><br />Example:<br /><code><br />select salary,lag(salary+300,1,0) over (order by salary) as new_sal,lag(salary+200,2,0) over (order by salary) as new_sal2 from employees;<br /></code></div><br /><br /><iframe align="left" frameborder="0" marginheight="0" marginwidth="0" scrolling="no" src="http://rcm.amazon.com/e/cm?t=thelaccur-20&amp;o=1&amp;p=8&amp;l=bpl&amp;asins=0672325675&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;m=amazon&amp;lc1=0000FF&amp;bc1=000000&amp;bg1=FFFFFF&amp;f=ifr" style="align: left; height: 245px; padding-right: 10px; padding-top: 5px; width: 131px;"></iframe>&nbsp;<iframe align="left" frameborder="0" marginheight="0" marginwidth="0" scrolling="no" src="http://rcm.amazon.com/e/cm?t=thelaccur-20&amp;o=1&amp;p=8&amp;l=bpl&amp;asins=0596520832&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;m=amazon&amp;lc1=0000FF&amp;bc1=000000&amp;bg1=FFFFFF&amp;f=ifr" style="align: left; height: 245px; padding-right: 10px; padding-top: 5px; width: 131px;"></iframe>&nbsp;<iframe align="left" frameborder="0" marginheight="0" marginwidth="0" scrolling="no" src="http://rcm.amazon.com/e/cm?t=thelaccur-20&amp;o=1&amp;p=8&amp;l=bpl&amp;asins=0596526849&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;m=amazon&amp;lc1=0000FF&amp;bc1=000000&amp;bg1=FFFFFF&amp;f=ifr" style="align: left; height: 245px; padding-right: 10px; padding-top: 5px; width: 131px;"></iframe>&nbsp;<iframe align="left" frameborder="0" marginheight="0" marginwidth="0" scrolling="no" src="http://rcm.amazon.com/e/cm?t=thelaccur-20&amp;o=1&amp;p=8&amp;l=bpl&amp;asins=0596009763&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;m=amazon&amp;lc1=0000FF&amp;bc1=000000&amp;bg1=FFFFFF&amp;f=ifr" style="align: left; height: 245px; padding-right: 10px; padding-top: 5px; width: 131px;"></iframe></div><div class="blogger-post-footer"><div style="border-top: 1px solid #efefef; margin-top: 5px;">
Thank you for reading. This blog post was originally posted to <a href="http://tech.deepumohan.com/">Deepu's Technology Blog</a>.
</div></div></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Deepu Mohan Puthrote</div>
<div class='content'>
point noted!<br />I&#39;ll try to be more descriptive.<br />and for you, whoever you are, don&#39;t be anonymous<br />:)</div>
</div>
<div class='comment'>
<div class='author'>Anonymous</div>
<div class='content'>
be more elaborative</div>
</div>
</div>
