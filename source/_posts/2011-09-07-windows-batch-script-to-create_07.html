---
layout: post
title: "Windows batch script to create directory auto file name DDMONYYYY with the help of javascript"
date: 2011-09-07T17:54:00+05:30
categories:
 - Batch Script
 - Windows XP
---

<div class='post'>
<div dir="ltr" style="text-align: left;" trbidi="on"><div style="text-align: justify;">In the <a href="/2011/09/windows-batch-script-to-create.html">previous post</a> I had shown a windows batch script for creating directories with name of format <b>DDMMYYYY</b>. In this post I will show you how to create directories of format <b>DDMONYYYY</b>. I did a lot of research on web to figure this out. Here is the script, it looks a little bit complex.<br /><br /></div><pre class="brush:bash; ruler: true; gutter:true; toolbar: true;">:: Auto directory date batch (DDMONYYYY format)<br />:: In Win32, use WSH/JS to create directory in format DDMONYYYY,<br />:: using temporary javascript and batch files.<br />:: JS file is used for for getting MON<br />:: @author Deepu Mohan Puthrote www.deepumohan.com<br />@echo off<br />:: Declare function fnMonthLookUp<br />echo function fnMonthLookUp () {} &gt; tmpDate.js<br />:: Create array on fnMonthLookUp<br />echo fnMonthLookUp['1'] = 'JAN'; &gt;&gt; tmpDate.js<br />echo fnMonthLookUp['2'] = 'FEB'; &gt;&gt; tmpDate.js<br />echo fnMonthLookUp['3'] = 'MAR'; &gt;&gt; tmpDate.js<br />echo fnMonthLookUp['4'] = 'APR'; &gt;&gt; tmpDate.js<br />echo fnMonthLookUp['5'] = 'MAY'; &gt;&gt; tmpDate.js<br />echo fnMonthLookUp['6'] = 'JUN'; &gt;&gt; tmpDate.js<br />echo fnMonthLookUp['7'] = 'JUL'; &gt;&gt; tmpDate.js<br />echo fnMonthLookUp['8'] = 'AUG'; &gt;&gt; tmpDate.js<br />echo fnMonthLookUp['9'] = 'SEP'; &gt;&gt; tmpDate.js<br />echo fnMonthLookUp['10'] = 'OCT'; &gt;&gt; tmpDate.js<br />echo fnMonthLookUp['11'] = 'NOV'; &gt;&gt; tmpDate.js<br />echo fnMonthLookUp['12'] = 'DEC'; &gt;&gt; tmpDate.js<br />:: Get Date<br />echo var D = new Date(); &gt;&gt; tmpDate.js<br />echo var dd = D.getDate(); &gt;&gt; tmpDate.js<br />echo var mm = D.getMonth()+1; &gt;&gt; tmpDate.js<br />echo var yyyy = D.getFullYear(); &gt;&gt; tmpDate.js<br />echo var mon = fnMonthLookUp[mm]; &gt;&gt; tmpDate.js<br />echo var date = dd + mon + yyyy; &gt;&gt; tmpDate.js<br />echo WScript.Echo('mkdir '+date); &gt;&gt;tmpDate.js<br /><br />cscript //nologo tmpDate.js &gt; tmpDate.bat<br />del tmpDate.js<br />call tmpDate<br />del tmpDate.bat<br /><br /></pre><br />Copy and paste this code into a file with extension <b>bat</b> and save it into a path where you want to create the directory. Please do share your comments.<br /><br />You can also download the batch file from <a href="http://files.deepumohan.com/winbatch/DDMONYYYY.bat"> here</a>. You can safely download it, it is hosted is safe server of <a href="http://secure.hostgator.com/%7Eaffiliat/cgi-bin/affiliates/clickthru.cgi?id=deepumohanp">HostGator</a>.<br /><br />The above script creates a tempDate.js and tempDate.bat file. Windows can run javascript file using the command <a href="http://technet.microsoft.com/en-us/library/bb490887.aspx">cscript</a>. Output of this javascript file is taken to tmpDate.bat file.<br />A sample javascript file generated by the above code is given below.<br /><br /><pre class="brush:js; ruler: true; gutter:true; toolbar: true;">function fnMonthLookUp () {} <br />fnMonthLookUp['1'] = 'JAN'; <br />fnMonthLookUp['2'] = 'FEB'; <br />fnMonthLookUp['3'] = 'MAR'; <br />fnMonthLookUp['4'] = 'APR'; <br />fnMonthLookUp['5'] = 'MAY'; <br />fnMonthLookUp['6'] = 'JUN'; <br />fnMonthLookUp['7'] = 'JUL'; <br />fnMonthLookUp['8'] = 'AUG'; <br />fnMonthLookUp['9'] = 'SEP'; <br />fnMonthLookUp['10'] = 'OCT'; <br />fnMonthLookUp['11'] = 'NOV'; <br />fnMonthLookUp['12'] = 'DEC'; <br />var D = new Date(); <br />var dd = D.getDate(); <br />var mm = D.getMonth()+1; <br />var yyyy = D.getFullYear(); <br />var mon = fnMonthLookUp[mm]; <br />var date = dd + mon + yyyy; <br />WScript.Echo('mkdir '+date); <br /><br /></pre>As you can see a javascript array is created that holds index for each month. Next we create a new Date object using javascript function <code>new Date()</code>. From the date object get the <i>date</i>, <i>month</i> and <i>year.</i>&nbsp;Next we get the MON format of month from the javascript array already created. Now in <code>date</code> variable we have the date in the required format. <code>WScript.Echo()</code> command will give the output. And the output will be <b>mkdir <i>DDMONYYYY</i></b>. This output is taken into the tmpDate.bat file. Then the tmpDate.js file is deleted and tmpDate.bat file is executed using the call command.<br /><br />In the next post I shall give an improved version.<br /><br />For those who are new to windows batch files, visit&nbsp;<a href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/batch.mspx?mfr=true">this site</a>&nbsp;by&nbsp;<a href="http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/batch.mspx?mfr=true">Microsoft</a>. You can also get these very good books from Amazon.com.<br /><div><iframe align="left" frameborder="0" marginheight="0" marginwidth="0" scrolling="no" src="http://rcm.amazon.com/e/cm?t=thelaccur-20&amp;o=1&amp;p=8&amp;l=bpl&amp;asins=1861002653&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;m=amazon&amp;lc1=0000FF&amp;bc1=000000&amp;bg1=FFFFFF&amp;f=ifr" style="height: 245px; padding-right: 10px; padding-top: 5px; width: 131px;"></iframe>&nbsp;<iframe align="left" frameborder="0" marginheight="0" marginwidth="0" scrolling="no" src="http://rcm.amazon.com/e/cm?t=thelaccur-20&amp;o=1&amp;p=8&amp;l=bpl&amp;asins=0079120482&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;m=amazon&amp;lc1=0000FF&amp;bc1=000000&amp;bg1=FFFFFF&amp;f=ifr" style="height: 245px; padding-right: 10px; padding-top: 5px; width: 131px;"></iframe><iframe align="left" frameborder="0" marginheight="0" marginwidth="0" scrolling="no" src="http://rcm.amazon.com/e/cm?t=thelaccur-20&amp;o=1&amp;p=8&amp;l=bpl&amp;asins=0735620385&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;m=amazon&amp;lc1=0000FF&amp;bc1=000000&amp;bg1=FFFFFF&amp;f=ifr" style="height: 245px; padding-right: 10px; padding-top: 5px; width: 131px;"></iframe>&nbsp;&nbsp;<iframe align="left" frameborder="0" marginheight="0" marginwidth="0" scrolling="no" src="http://rcm.amazon.com/e/cm?t=thelaccur-20&amp;o=1&amp;p=8&amp;l=bpl&amp;asins=1887902821&amp;fc1=000000&amp;IS2=1&amp;lt1=_blank&amp;m=amazon&amp;lc1=0000FF&amp;bc1=000000&amp;bg1=FFFFFF&amp;f=ifr" style="height: 245px; padding-right: 10px; padding-top: 5px; width: 131px;"></iframe></div><br /></div><div class="blogger-post-footer"><div style="border-top: 1px solid #efefef; margin-top: 5px;">
Thank you for reading. This blog post was originally posted to <a href="http://tech.deepumohan.com/">Deepu's Technology Blog</a>.
</div></div></div>
