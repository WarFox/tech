# our build should run within a Ruby box
box: wercker/ruby

build:
    steps:
        # Run a smart version of bundle install
        # which improves build execution time of
        # future builds
        - bundle-install

        # A custom script step
        # that actually builds the jekyll site
        - script:
            name: generate site
            code: bundle exec jekyll build --trace

deploy:
    steps:
        - add-to-known_hosts:
            hostname: direct.deepumohan.com
        - mktemp:
            envvar: PRIVATEKEY_PATH
        - create-file:
            name: write key
            filename: $PRIVATEKEY_PATH
            content: $PRODUCTION_PRIVATE
            overwrite: true
            hide-from-log: true
        - script:
            name: transfer files
            code: |
                pwd
                ls -la
                rsync -avzre ssh -i $PRIVATEKEY_PATH -o StrictHostKeyChecking=no -o UserKnownHostsFile=no -P $PORT --progress public/* warfox@direct.deepumohan.com:~/public_html/deepumohan.com/tech
