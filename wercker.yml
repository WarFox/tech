box: node:6.11.0
build:
  steps:
    - npm-install

    - script:
        name: echo nodejs information
        code: |
          echo "node version $(node -v) running"
          echo "npm version $(npm -v) running"
    - script:
        name: Install Hexo
        code: |
          sudo npm install -g hexo-cli
    - script:
        name: Rebuild node-sass
        code: |
          npm rebuild node-sass
    - script:
        name: Generate static files
        code: |
          hexo generate

deploy:
    steps:
        - script:
            name: install open ssh
            code: apt-get update && apt-get install -y openssh-client
        - add-ssh-key:
            keyname: PRODUCTION
        - add-to-known_hosts:
            hostname: $HOST
        - script:
            name: transfer files
            code: |
                scp -o StrictHostKeyChecking=no -o UserKnownHostsFile=no -P $PORT -v -r public/* $USER@$HOST:$DIRECTORY
